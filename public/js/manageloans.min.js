function refreshLoans() {
    $.post(SERVER_ABSOLUTE_PATH + "/mesprets/getLoans", function(a) {
        var b = JSON.parse(a);
        $("#tableBody").empty(), $("#mobileTable").empty(), $.each(b, function(a, b) {
            $("#tableBody").append("<tr><td>" + b.LoansContactName + "</td><td>" + b.ContactMail + "</td><td>" + b.ContactTel + "</td><td>" + b.LoanDate + "</td><td class='LoanExpDate" + b.LoanId + "'>" + b.LoanExpDate + "</td><td><a href='#'>" + b.ObjectName + "</a></td><td><ul class='button-group radius text-center'><li><a id='" + b.LoanId + "' name='btExtend' href='#' class='small button' title='Prolonger' ><i class='fa fa-clock-o'></i></a></li><li><a id='" + b.LoanId + "' name='btReceived' href='#' class='small button' title='Reçu'><i class='fa fa-check'></i></a></li></ul></td><tr/>"), $("#mobileTable").append("<li><ul class='vcard show-for-small-only'><li class='fn'>" + b.ContactName + "</li><li class='Mail'>" + b.ContactMail + "</li><li>" + b.ContactTel + "</li><li>" + b.LoanDate + "</li><li class='LoanExpDate" + b.LoanId + "'>" + b.LoanExpDate + "</li><li><a href='#'>" + b.ObjectName + "</a></li><li><ul class='button-group radius'><li><a id='" + b.LoanId + "'  name='btExtend' href='#' class='small button' title='Prolonger'><i class='fa fa-clock-o'></i></a></li><li><a id='" + b.LoanId + "' name='btReceived' href='#' class='small button' title='Reçu'><i class='fa fa-check'></i></a></li></ul></li></ul></li>")
        })
    })
}
$.getScript("config.min.js"), $(document).foundation(), $(document).foundation("abide", "events"), $("#frmExtendLoan").on("valid", function() {
    $.post(SERVER_ABSOLUTE_PATH + "/mesprets/extendDate", {
        LoanId: $("#LoanId").val(),
        LoanExpDate: $("#txtDate").val()
    }, function() {
        $(".LoanExpDate" + $("#LoanId").val()).text($("#txtDate").val()), $("#extendLoan").foundation("reveal", "close")
    })
}), $("#tableBody, #mobileTable").on("click", "a[name='btExtend']", function() {
    var a = $(this).attr("id");
    $("#LoanId").val(a), $("#extendLoan").foundation("reveal", "open")
}), $("#tableBody, #mobileTable").on("click", "a[name='btReceived']", function() {
    var a = $(this).attr("id");
    $.post(SERVER_ABSOLUTE_PATH + "/mesprets/deleteLoan", {
        LoanId: a
    }, function() {
        refreshLoans()
    })
});