function refreshFamilyOwners() {
    $.post(SERVER_ABSOLUTE_PATH + "/sysadmin/getFamilyOwners", function(a) {
        var b = JSON.parse(a);
        $("#tableBody").empty(), $("#mobileTable").empty(), $.each(b, function(a, b) {
            var c = "";
            1 == b.UserInfoStatus && (c = "checked"), $("#tableBody").append("<tr><td>" + b.UserId + "</td><td><a href='mailto:" + b.UserName + "' class='nameFixedWidth'>" + b.UserName + "</a></td><td>" + b.UserInfoFirstName + " " + b.UserInfoLastName + "</td><td><a href='tel:" + b.UserInfoTel + "'>" + b.UserInfoTel[0] + " (" + b.UserInfoTel.substring(1, 4) + ") " + b.UserInfoTel.substring(4, 7) + "-" + b.UserInfoTel.substring(7, 11) + "</a></td><td><div class='switch tiny'><input id='chkActivation" + b.UserId + "'" + c + " type='checkbox'><label for='chkActivation" + b.UserId + "'></label></div></td><td><ul class='button-group radius'><li><a id='btnEdit" + b.UserId + "' href='#' class='small button'><i class='fa fa-pencil fa-lg'></i></a></li><li><a id='btnDelete" + b.UserId + "' href='#' class='small button'><i class='fa fa-trash-o fa-lg'></i></a></li></ul></td></tr>"), $("#mobileTable").append("<li><ul class='vcard show-for-small-only'><li class='fn'>" + b.UserInfoFirstName + " " + b.UserInfoLastName + "</li><li class='Mail'>" + b.UserName + "</li><li>" + b.UserInfoTel[0] + " (" + b.UserInfoTel.substring(1, 4) + ") " + b.UserInfoTel.substring(4, 7) + "-" + b.UserInfoTel.substring(7, 11) + "</li><li><div class='switch tiny'><input id='smallChkActivation" + b.UserId + "'" + c + "  type='checkbox'><label for='smallChkActivation" + b.UserId + "'></label></div></li><li><ul class='button-group radius'><li><a id='btnEdit" + b.UserId + "' href='#' class='small button'><i class='fa fa-pencil fa-lg'></i></a></li><li><a id='btnDelete" + b.UserId + "' href='#' class='small button'><i class='fa fa-trash-o fa-lg'></i></a></li></ul></li></ul></li>")
        })
    })
}
$.getScript("config.min.js"), $(document).foundation(), $(document).foundation("abide", "events"), $("#searchInput").on("keyup", function() {
    var a = $(this).val();
    "" != a ? ($("#mobileTable li").show(), $("#mobileTable li:not(:contains('" + a + "'))").hide(), $("#tableBody tr").show(), $("#tableBody tr:not(:contains('" + a + "'))").hide()) : ($("#mobileTable li").show(), $("#tableBody tr").show())
}), 
$("#tableBody, #mobileTable").on("click", "input[type='checkbox']", function() {
    var a = $(this).attr("id").replace(/[^0-9]/g, ""),
        b = SERVER_ABSOLUTE_PATH + "/sysadmin/setFamilyAdminActivation";
    $.post(b, {
        adminId: a
    }, function() {
        refreshFamilyOwners()
    })
}), 
$("#tableBody, #mobileTable").on("click", "[id*='btnEdit']", function() {
    var a = $(this).attr("id").replace(/[^0-9]/g, "");
    $.post(SERVER_ABSOLUTE_PATH + "/sysadmin/getFamilyOwner", {
        familyOwnerId: a
    }, function(b) {
        var c = JSON.parse(b);
        $("input[name='txtEditUserName']").val(c.UserName), $("input[name='txtEditFirstName']").val(c.UserInfoFirstName), $("input[name='txtEditLastName']").val(c.UserInfoLastName), $("input[name='txtEditPhone']").val(c.UserInfoTel), $("input[type='hidden']").val(a)
    }), $("#editModal").foundation("reveal", "open")
}), 
$("#tableBody, #mobileTable").on("click", "[id*='btnDelete']", function() {
    var a = ($(this).attr("id").replace(/[^0-9]/g, ""), $(this).closest("tr").children("td").eq(2).text());
    $("#deleteWarning p:first").data("btnRef", $(this).attr("id")), $("#deleteWarning p:first").html("Vous vous apprétez à supprimer <strong>" + a + "</strong>. Voulez vous continuer?"), $("#deleteWarning").foundation("reveal", "open")
}), 
$("#btnModalDelete").click(function() {
    var a = SERVER_ABSOLUTE_PATH + "/sysadmin/deleteFamilyAdmin",
        b = $("#deleteWarning p:first").data("btnRef").replace(/[^0-9]/g, "");
    $.post(a, {
        adminId: b
    }, 
    function() {
        $("#" + $("#deleteWarning p:first").data("btnRef")).closest("tr").remove(), refreshFamilyOwners()
    }), 
    $("#deleteWarning").foundation("reveal", "close")
}), 
$(".btnModalCancel").click(function() {
    $("#deleteWarning").foundation("reveal", "close")
}), 
$("#frmEditFamilyOwner").on("valid", function() {
    $.post(SERVER_ABSOLUTE_PATH + "/sysadmin/editFamilyAdmin", {
        UserId: $("#UserId").val(),
        UserName: $("input[name='txtEditUserName']").val(),
        UserInfoFirstName: $("input[name='txtEditFirstName']").val(),
        UserInfoLastName: $("input[name='txtEditLastName']").val(),
        UserInfoTel: $("input[name='txtEditPhone']").val(),
        UserPass: $("input[name='txtEditPassword']").val()
    }, 
    function() {
        refreshFamilyOwners(), $("#editModal").foundation("reveal", "close")
    })
}), 
$("#frmAddFamilyOwner").on("valid", function() {
    $.post(SERVER_ABSOLUTE_PATH + "/sysadmin/addFamilyAdmin", {
        UserName: $("input[name='txtAddUserName']").val(),
        UserInfoFirstName: $("input[name='txtAddFirstName']").val(),
        UserInfoLastName: $("input[name='txtAddLastName']").val(),
        UserInfoTel: $("input[name='txtAddPhone']").val(),
        UserPass: $("input[name='txtAddPassword']").val()
    }, 
    function(a) {
        var b = !1;
        if (0 != a.length) {
            var c = JSON.parse(a);
            c.hasOwnProperty("errors") && ($("#errors").empty(), $.each(c, function(a, b) {
                $("#errors").append(b), $("#errorModal").foundation("reveal", "open")
            }), b = !0)
        }
        b || (refreshFamilyOwners(), $("input[name='txtAddUserName']").val(""), $("input[name='txtAddFirstName']").val(""), $("input[name='txtAddLastName']").val(""), $("input[name='txtAddPhone']").val(""), $("input[name='txtAddPassword']").val(""), $("input[name='txtConfirmPassword']").val(""), $("#addModal").foundation("reveal", "close"))
    })
});